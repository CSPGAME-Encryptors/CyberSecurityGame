---
layout: page
title: Mission 2 ‚Äî Fix the Wormhole
permalink: /digital-famine/cyber/mission-2-lesson/
<<<<<<< ours
<<<<<<< ours
---

<link rel="stylesheet" href="styles.css" />

<section class="mission-hero">
  <div class="hero-sprites">
    <span class="sprite sprite--drone"></span>
    <span class="sprite sprite--ufo"></span>
  </div>
  <div class="hero-copy">
    <p class="mission-label">Mission 2</p>
    <h1>Patch the Wormhole</h1>
    <p class="lead">
      The alien syndicate is funneling Earth‚Äôs agent database through a SQL injection wormhole. Reproduce their payload,
      diagnose the flaw, then deploy parameterized defenses before the data stream is lost.
    </p>
    <div class="mission-stats">
      <div class="stat-card">
        <p class="stat-label">Attempts</p>
        <p class="stat-value" id="stat-attempts">0</p>
      </div>
      <div class="stat-card">
        <p class="stat-label">Breach Alerts</p>
        <p class="stat-value danger" id="stat-breaches">0</p>
      </div>
      <div class="stat-card">
        <p class="stat-label">Secure Runs</p>
        <p class="stat-value success" id="stat-secure">0</p>
      </div>
    </div>
  </div>
</section>

<section class="mission-brief">
  <article class="brief-card">
    <h2>Scenario Intel</h2>
    <p>
      An obsolete login endpoint concatenates user input straight into SQL. The payload
      <code>' OR '1'='1</code> turns every WHERE clause into a universal pass.
    </p>
    <p>The longer the vulnerability stays open, the faster the wormhole destabilizes the agent archive.</p>
  </article>
  <article class="brief-card">
    <h2>Learning Targets</h2>
    <ul>
      <li>Explain why string concatenation enables SQL injection.</li>
      <li>Demonstrate how parameterized queries neutralize rogue input.</li>
      <li>Document secure coding practices for future mission teams.</li>
    </ul>
  </article>
  <article class="brief-card">
    <h2>Tools Online</h2>
    <ul>
      <li>SQL query console with live comparison.</li>
      <li>Threat meter visualizing breach severity.</li>
      <li>Mission log for validated takeaways.</li>
    </ul>
  </article>
</section>

<section class="wormhole-lab">
  <div class="wormhole-visual" id="wormhole">
    <div class="wormhole-core"></div>
    <div class="wormhole-ring wormhole-ring--outer"></div>
    <div class="wormhole-ring wormhole-ring--inner"></div>
    <div class="wormhole-energy"></div>
  </div>

  <div class="meter-panel">
    <div class="meter-header">
      <h2>Infiltration Meter</h2>
      <span id="meter-status" class="meter-status">Status: Stable</span>
    </div>
    <div class="meter-track">
      <div id="meter-bar" class="meter-bar"></div>
    </div>
    <p class="meter-caption">
      Insecure queries crank the threat meter into the red. Drop the payload with secure mode enabled to collapse the wormhole.
    </p>
  </div>
</section>

<section class="training-grid">
  <article class="training-card">
    <h3>Phase 1 ¬∑ Recon</h3>
    <p>Run the alien payload through the legacy endpoint and inspect the query string it produces.</p>
    <ul>
      <li>Identify the portion of the WHERE clause that the payload overwrites.</li>
      <li>Record the vulnerable query for your report.</li>
    </ul>
  </article>
  <article class="training-card">
    <h3>Phase 2 ¬∑ Harden</h3>
    <p>Activate parameterized queries to bind user input separately from the SQL template.</p>
    <ul>
      <li>Re-run the same payload under secure mode.</li>
      <li>Observe how the query structure stays intact.</li>
    </ul>
  </article>
  <article class="training-card">
    <h3>Phase 3 ¬∑ Verify</h3>
    <p>Authenticate with legitimate credentials to ensure defense mechanisms don‚Äôt block valid agents.</p>
    <ul>
      <li>Create test accounts in the simulation below.</li>
      <li>Confirm expected rows are returned while the payload fails.</li>
    </ul>
  </article>
</section>

<section class="lab-section">
  <div class="lab-console">
    <h2>Vulnerability Lab</h2>
    <p>Experiment with the login form. The command log shows the exact SQL executed and the resulting rows.</p>

    <form id="lab-form" class="lab-form">
      <div class="form-row">
        <label for="input-codename">Codename</label>
        <input id="input-codename" name="codename" placeholder="GhostWolf" required />
      </div>
      <div class="form-row">
        <label for="input-passcode">Passcode</label>
        <input id="input-passcode" name="passcode" placeholder="hunter2" required />
      </div>
      <div class="toggle-row">
        <label class="toggle">
          <input type="checkbox" id="toggle-secure" />
          <span class="toggle-slider"></span>
        </label>
        <div class="toggle-copy">
          <strong>Secure Mode</strong>
          <p>Use parameterized queries &amp; input validation</p>
        </div>
      </div>
      <button type="submit" class="cta">Execute Query</button>
    </form>

    <div class="lab-stats">
      <div class="badge" id="badge-status">No breaches detected.</div>
      <div class="badge code">Code Fragment: <span id="badge-code">‚Äî</span></div>
    </div>
  </div>

  <div class="lab-log">
    <h3>Command Log</h3>
    <pre id="log-output">$ Awaiting orders‚Ä¶</pre>

    <div class="indicator-grid">
      <div class="indicator" id="indicator-breach">Breach Status: Unknown</div>
      <div class="indicator" id="indicator-telemetry">Telemetry: No anomalies</div>
    </div>
  </div>
</section>

<section class="mission-checklist">
  <h2>Secure Coding Checklist</h2>
  <ol>
    <li>Mirror the attack: run the payload and capture the vulnerable SQL statement.</li>
    <li>Refactor to parameterized queries and rerun the payload.</li>
    <li>Validate legitimate users still succeed.</li>
    <li>Document the fix and submit the BRAVO fragment to HQ.</li>
  </ol>
</section>

<section class="debrief">
  <h2>Debrief &amp; Reflection</h2>
  <div class="debrief-grid">
    <article>
      <h3>Forensics Log</h3>
      <p>String concatenation let the payload rewrite the WHERE clause and leak every agent record.</p>
      <p>Prepared statements preserved the structure, treating the payload as literal text instead of executable SQL.</p>
    </article>
    <article>
      <h3>Action Items</h3>
      <ul>
        <li>Refactor every database helper to use parameter binding APIs.</li>
        <li>Add automated tests that fire the injection payload at new endpoints.</li>
        <li>Share coding standards that outlaw dynamic SQL built from user strings.</li>
      </ul>
    </article>
    <article>
      <h3>Success Code</h3>
      <p class="success-code" id="success-code">Pending</p>
      <p class="caption">Your BRAVO fragment unlocks the final vault once the wormhole is stable.</p>
    </article>
  </div>

  <div class="reflection">
    <h3>Mission Reflection</h3>
    <details>
      <summary>What did the injection exploit?</summary>
      <p>Unescaped input turned the conditional logic into a tautology (<code>1=1</code>), so every row satisfied the query.</p>
    </details>
    <details>
      <summary>How did parameter binding solve it?</summary>
      <p>The SQL engine received a precompiled statement with placeholders, and the payload was bound as data, not syntax.</p>
    </details>
    <details>
      <summary>How will you prevent future breaches?</summary>
      <p>Create a shared database module that enforces parameterized queries, sanitizes input, and audits suspicious requests.</p>
    </details>
  </div>
</section>

<script src="script.js" defer></script>
=======
=======
>>>>>>> theirs
author: Aaryav Lal
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mission 2 ¬∑ Patch the Wormhole</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        background: radial-gradient(circle at top, rgba(103, 232, 249, 0.18), transparent 55%),
          radial-gradient(circle at bottom right, rgba(192, 132, 252, 0.18), transparent 45%), #050a1a;
        min-height: 100vh;
      }

      .pulse {
        animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
      }

      @keyframes pulse {
        0%, 100% {
          opacity: 1;
        }
        50% {
          opacity: 0.6;
        }
      }

      .section-hidden {
        display: none;
      }
    </style>
  </head>

  <body class="text-slate-100">
    <header class="border-b border-purple-500/30 bg-slate-900/60 backdrop-blur">
      <div class="max-w-7xl mx-auto px-4 py-6 text-center space-y-2">
        <p class="text-sm uppercase tracking-[0.35em] text-purple-300/80">Cybersecurity Game ¬∑ Alien Defense</p>
        <h1 class="text-4xl md:text-5xl font-bold">Mission 2 ¬∑ Patch the Wormhole</h1>
        <p class="text-purple-200 text-base md:text-lg">
          Stop the SQL injection siphon before the alien syndicate drains the agent database.
        </p>
      </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 py-10 space-y-10">
      <!-- Navigation -->
      <nav class="bg-slate-900/70 border border-purple-500/20 rounded-2xl p-5 backdrop-blur">
        <div class="flex flex-wrap items-center justify-center gap-3 md:gap-4">
          <button
            class="mission-nav-btn bg-purple-600 hover:bg-purple-500 text-white px-4 py-3 rounded-xl transition shadow-lg shadow-purple-500/20 flex flex-col items-center min-w-[110px]"
            data-section="0"
          >
            <span class="text-2xl mb-1">üõ∞Ô∏è</span>
            <span class="text-xs tracking-wide uppercase">Briefing</span>
          </button>
          <button class="mission-nav-btn nav-idle" data-section="1">
            <span class="text-2xl mb-1">‚ö†Ô∏è</span>
            <span class="text-xs tracking-wide uppercase">Threat</span>
          </button>
          <button class="mission-nav-btn nav-idle" data-section="2">
            <span class="text-2xl mb-1">üß™</span>
            <span class="text-xs tracking-wide uppercase">Exploit</span>
          </button>
          <button class="mission-nav-btn nav-idle" data-section="3">
            <span class="text-2xl mb-1">üõ°Ô∏è</span>
            <span class="text-xs tracking-wide uppercase">Harden</span>
          </button>
          <button class="mission-nav-btn nav-idle" data-section="4">
            <span class="text-2xl mb-1">üß≠</span>
            <span class="text-xs tracking-wide uppercase">Verify</span>
          </button>
          <button class="mission-nav-btn nav-idle" data-section="5">
            <span class="text-2xl mb-1">üìú</span>
            <span class="text-xs tracking-wide uppercase">Debrief</span>
          </button>
        </div>
      </nav>

      <!-- Section 0 -->
      <section id="section-0" class="mission-section space-y-6">
        <div class="bg-slate-900/70 border border-rose-500/40 rounded-2xl px-6 py-8 md:px-10 md:py-12 shadow-xl shadow-rose-500/10">
          <div class="flex flex-col md:flex-row md:items-center gap-6">
            <div class="text-5xl pulse">üõ∞Ô∏è</div>
            <div class="space-y-4">
              <h2 class="text-3xl font-semibold text-rose-300">Incoming Distress Signal</h2>
              <p class="text-lg text-slate-200">
                Commander, the Syndicate‚Äôs SQL injection wormhole is siphoning confidential agent intel.
                Recreate the breach with their payload, then rewrite the login layer with secure queries before we lose the archive.
              </p>
              <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 text-center">
                <div class="bg-slate-950/70 border border-purple-500/30 rounded-xl py-4">
                  <p class="text-xs uppercase tracking-widest text-slate-300">Mission Time</p>
                  <p class="text-2xl font-semibold text-purple-200">25 - 35 min</p>
                </div>
                <div class="bg-slate-950/70 border border-purple-500/30 rounded-xl py-4">
                  <p class="text-xs uppercase tracking-widest text-slate-300">Difficulty</p>
                  <p class="text-2xl font-semibold text-purple-200">‚≠ê‚≠ê‚≠ê‚òÜ‚òÜ</p>
                </div>
                <div class="bg-slate-950/70 border border-purple-500/30 rounded-xl py-4">
                  <p class="text-xs uppercase tracking-widest text-slate-300">Reward</p>
                  <p class="text-2xl font-semibold text-yellow-300">BRAVO-4M8Q</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <button
          class="w-full md:w-auto bg-purple-600 hover:bg-purple-500 transition px-6 py-3 rounded-xl font-semibold shadow-lg shadow-purple-500/30"
          onclick="goToSection(1)"
        >
          Proceed to Threat Analysis ‚Üí
        </button>
      </section>

      <!-- Section 1 -->
      <section id="section-1" class="mission-section section-hidden space-y-6">
        <div class="bg-slate-900/70 border border-purple-500/30 rounded-2xl px-6 py-8 md:px-10 md:py-12">
          <h2 class="text-3xl font-semibold text-purple-200 mb-6">Threat Analysis ¬∑ SQL Injection 101</h2>
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <article class="bg-slate-950/70 border border-purple-500/20 rounded-xl p-6 space-y-4">
              <h3 class="text-xl font-semibold text-purple-200">How the Wormhole Works</h3>
              <p>
                The login form concatenates user input directly into SQL. When the payload
                <code class="bg-slate-800/70 px-2 py-1 rounded"> ' OR '1'='1 </code>
                is injected, the WHERE clause is rewritten, forcing the database to return every row.
              </p>
              <pre class="bg-slate-900/70 border border-purple-500/20 rounded-lg p-4 text-sm overflow-x-auto">
SELECT * FROM agents
WHERE codename = '<span class="text-rose-300">GhostWolf' OR '1'='1</span>'
AND passcode = '<span class="text-rose-300">hunter2' OR '1'='1</span>';
              </pre>
              <p class="text-slate-300">
                The conditional is now a permanent truth. The wormhole stays open, pouring the entire agents table into enemy hands.
              </p>
            </article>

            <article class="bg-slate-950/70 border border-emerald-500/20 rounded-xl p-6 space-y-4">
              <h3 class="text-xl font-semibold text-emerald-200">The Fix in Theory</h3>
              <p>
                Prepared statements separate SQL structure from user data. The payload is treated as a literal string, not executable SQL.
              </p>
              <pre class="bg-slate-900/70 border border-emerald-500/20 rounded-lg p-4 text-sm overflow-x-auto">
const stmt = db.prepare(
  "SELECT * FROM agents WHERE codename = ? AND passcode = ?"
);
stmt.bind([codename, passcode]);
const result = stmt.getAsObject();
              </pre>
              <p class="text-slate-300">
                When the payload is bound to a placeholder, the database engine cannot reinterpret the WHERE clause.
                The wormhole collapses.
              </p>
            </article>
          </div>
        </div>

        <div class="flex flex-col md:flex-row gap-3 justify-between">
          <button
            class="w-full md:w-auto bg-slate-800/80 hover:bg-slate-700/80 px-6 py-3 rounded-xl transition"
            onclick="goToSection(0)"
          >
            ‚Üê Return to Briefing
          </button>
          <button
            class="w-full md:w-auto bg-purple-600 hover:bg-purple-500 px-6 py-3 rounded-xl font-semibold transition"
            onclick="goToSection(2)"
          >
            Launch Exploit Simulation ‚Üí
          </button>
        </div>
      </section>

      <!-- Section 2 -->
      <section id="section-2" class="mission-section section-hidden space-y-6">
        <div class="bg-slate-900/70 border border-rose-500/30 rounded-2xl px-6 py-8 md:px-10 md:py-12">
          <h2 class="text-3xl font-semibold text-rose-200 mb-6">Exploit Sandbox ¬∑ Open the Wormhole</h2>
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <form id="exploit-form" class="space-y-5 bg-slate-950/70 border border-rose-500/20 rounded-xl p-6">
              <div>
                <label for="exploit-codename" class="block text-xs uppercase tracking-[0.3em] text-rose-200 mb-2">Codename</label>
                <input
                  id="exploit-codename"
                  class="w-full bg-slate-900/70 border border-rose-500/30 rounded-lg px-4 py-2 text-slate-100 focus:outline-none focus:ring-2 focus:ring-rose-400"
                  placeholder="GhostWolf"
                  required
                />
              </div>
              <div>
                <label for="exploit-passcode" class="block text-xs uppercase tracking-[0.3em] text-rose-200 mb-2">Passcode</label>
                <input
                  id="exploit-passcode"
                  class="w-full bg-slate-900/70 border border-rose-500/30 rounded-lg px-4 py-2 text-slate-100 focus:outline-none focus:ring-2 focus:ring-rose-400"
                  placeholder="hunter2"
                  required
                />
              </div>
              <button
                type="submit"
                class="w-full bg-rose-600 hover:bg-rose-500 transition py-2 rounded-xl font-semibold shadow-lg shadow-rose-500/20"
              >
                Execute Vulnerable Query
              </button>
              <p class="text-sm text-rose-200">
                Try the payload <code>' OR '1'='1</code> in either field to prove the wormhole stays open.
              </p>
            </form>

            <div class="bg-slate-950/70 border border-rose-500/20 rounded-xl p-6 space-y-4">
              <h3 class="text-xl font-semibold text-rose-200">Outcome</h3>
              <pre id="exploit-log" class="bg-slate-900/70 border border-rose-500/20 rounded-lg p-4 text-sm h-48 overflow-y-auto">$ Awaiting payload‚Ä¶</pre>
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm">
                <div class="bg-slate-900/80 border border-rose-500/20 rounded-lg px-4 py-2">
                  <p id="exploit-status" class="text-rose-300">Status: Unknown</p>
                </div>
                <div class="bg-slate-900/80 border border-rose-500/20 rounded-lg px-4 py-2">
                  <p id="exploit-leak" class="text-rose-300">Rows Returned: 0</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="flex flex-col md:flex-row gap-3 justify-between">
          <button class="w-full md:w-auto bg-slate-800/80 hover:bg-slate-700/80 px-6 py-3 rounded-xl" onclick="goToSection(1)">
            ‚Üê Return to Threat
          </button>
          <button class="w-full md:w-auto bg-purple-600 hover:bg-purple-500 px-6 py-3 rounded-xl font-semibold" onclick="goToSection(3)">
            Deploy Countermeasures ‚Üí
          </button>
        </div>
      </section>

      <!-- Section 3 -->
      <section id="section-3" class="mission-section section-hidden space-y-6">
        <div class="bg-slate-900/70 border border-emerald-500/30 rounded-2xl px-6 py-8 md:px-10 md:py-12">
          <h2 class="text-3xl font-semibold text-emerald-200 mb-6">Harden the Perimeter ¬∑ Parameterized Mode</h2>
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <form id="secure-form" class="space-y-5 bg-slate-950/70 border border-emerald-500/20 rounded-xl p-6">
              <div class="flex items-start gap-3 bg-emerald-500/10 border border-emerald-500/30 rounded-lg px-4 py-3">
                <span class="text-2xl">‚úÖ</span>
                <p class="text-sm text-emerald-100">
                  Prepared statements send SQL structure and user data separately. The payload becomes harmless text.
                </p>
              </div>
              <div>
                <label for="secure-codename" class="block text-xs uppercase tracking-[0.3em] text-emerald-200 mb-2">Codename</label>
                <input
                  id="secure-codename"
                  class="w-full bg-slate-900/70 border border-emerald-500/30 rounded-lg px-4 py-2 text-slate-100 focus:outline-none focus:ring-2 focus:ring-emerald-400"
                  placeholder="GhostWolf"
                  required
                />
              </div>
              <div>
                <label for="secure-passcode" class="block text-xs uppercase tracking-[0.3em] text-emerald-200 mb-2">Passcode</label>
                <input
                  id="secure-passcode"
                  class="w-full bg-slate-900/70 border border-emerald-500/30 rounded-lg px-4 py-2 text-slate-100 focus:outline-none focus:ring-2 focus:ring-emerald-400"
                  placeholder="hunter2"
                  required
                />
              </div>
              <button
                type="submit"
                class="w-full bg-emerald-600 hover:bg-emerald-500 transition py-2 rounded-xl font-semibold shadow-lg shadow-emerald-500/20"
              >
                Execute Secure Query
              </button>
            </form>

            <div class="bg-slate-950/70 border border-emerald-500/20 rounded-xl p-6 space-y-4">
              <h3 class="text-xl font-semibold text-emerald-200">Secure Output</h3>
              <pre id="secure-log" class="bg-slate-900/70 border border-emerald-500/20 rounded-lg p-4 text-sm h-48 overflow-y-auto">$ Awaiting secure mode‚Ä¶</pre>
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm">
                <div class="bg-slate-900/80 border border-emerald-500/20 rounded-lg px-4 py-2">
                  <p id="secure-status" class="text-emerald-300">Status: Unknown</p>
                </div>
                <div class="bg-slate-900/80 border border-emerald-500/20 rounded-lg px-4 py-2">
                  <p id="secure-fragment" class="text-emerald-300">Fragment: Pending</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="flex flex-col md:flex-row gap-3 justify-between">
          <button class="w-full md:w-auto bg-slate-800/80 hover:bg-slate-700/80 px-6 py-3 rounded-xl" onclick="goToSection(2)">
            ‚Üê Revisit Exploit
          </button>
          <button class="w-full md:w-auto bg-purple-600 hover:bg-purple-500 px-6 py-3 rounded-xl font-semibold" onclick="goToSection(4)">
            Validate &amp; Test ‚Üí
          </button>
        </div>
      </section>

      <!-- Section 4 -->
      <section id="section-4" class="mission-section section-hidden space-y-6">
        <div class="bg-slate-900/70 border border-sky-500/30 rounded-2xl px-6 py-8 md:px-10 md:py-12 space-y-6">
          <div class="flex flex-col md:flex-row md:items-center gap-6">
            <div class="text-4xl">üß≠</div>
            <div>
              <h2 class="text-3xl font-semibold text-sky-200 mb-4">Verification Checklist</h2>
              <p>
                Run normal credentials through secure mode. When the wormhole resists the payload but lets loyal agents through,
                the fragment is yours.
              </p>
            </div>
          </div>

          <div class="grid grid-cols-1 lg:grid-cols-3 gap-5">
            <div class="bg-slate-950/70 border border-sky-500/20 rounded-xl p-5 space-y-3">
              <h3 class="text-lg font-semibold text-sky-200">1. Capture Evidence</h3>
              <p class="text-sm text-slate-300">Screenshot the vulnerable and secure query output for your mission log.</p>
            </div>
            <div class="bg-slate-950/70 border border-sky-500/20 rounded-xl p-5 space-y-3">
              <h3 class="text-lg font-semibold text-sky-200">2. Automate Tests</h3>
              <p class="text-sm text-slate-300">Add a unit test that fires the payload at your login endpoint to ensure future regressions fail fast.</p>
            </div>
            <div class="bg-slate-950/70 border border-sky-500/20 rounded-xl p-5 space-y-3">
              <h3 class="text-lg font-semibold text-sky-200">3. Share Standards</h3>
              <p class="text-sm text-slate-300">Publish a secure coding snippet for teammates. Everyone must switch to parameterized helpers.</p>
            </div>
          </div>
        </div>

        <div class="flex flex-col md:flex-row gap-3 justify-between">
          <button class="w-full md:w-auto bg-slate-800/80 hover:bg-slate-700/80 px-6 py-3 rounded-xl" onclick="goToSection(3)">
            ‚Üê Re-run Countermeasures
          </button>
          <button class="w-full md:w-auto bg-purple-600 hover:bg-purple-500 px-6 py-3 rounded-xl font-semibold" onclick="goToSection(5)">
            Proceed to Debrief ‚Üí
          </button>
        </div>
      </section>

      <!-- Section 5 -->
      <section id="section-5" class="mission-section section-hidden space-y-6">
        <div class="bg-slate-900/70 border border-purple-500/30 rounded-2xl px-6 py-8 md:px-10 md:py-12 space-y-6">
          <h2 class="text-3xl font-semibold text-purple-200">Mission Debrief</h2>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <article class="bg-slate-950/70 border border-purple-500/20 rounded-xl p-6 space-y-3">
              <h3 class="text-lg font-semibold text-purple-200">Forensics Summary</h3>
              <p class="text-sm text-slate-200">
                SQL injection exploited unchecked string concatenation. Prepared statements neutralized the wormhole and restored data integrity.
              </p>
            </article>
            <article class="bg-slate-950/70 border border-purple-500/20 rounded-xl p-6 space-y-3">
              <h3 class="text-lg font-semibold text-purple-200">Secure Patterns</h3>
              <ul class="text-sm text-slate-200 list-disc list-inside space-y-2">
                <li>Always bind user input through parameters.</li>
                <li>Whitelist and validate critical fields.</li>
                <li>Log suspicious payloads for intrusion detection.</li>
              </ul>
            </article>
            <article class="bg-slate-950/70 border border-purple-500/20 rounded-xl p-6 space-y-3 text-center">
              <h3 class="text-lg font-semibold text-purple-200">Mission Reward</h3>
              <p class="text-3xl font-bold text-yellow-300">BRAVO-4M8Q</p>
              <p class="text-sm text-slate-300">Deliver the fragment to HQ to prep the vault lock sequence.</p>
            </article>
          </div>

          <div class="bg-slate-950/70 border border-purple-500/20 rounded-xl p-6 space-y-3">
            <h3 class="text-lg font-semibold text-purple-200">Reflection Questions</h3>
            <details class="bg-slate-900/70 border border-purple-500/20 rounded-lg px-4 py-3">
              <summary class="cursor-pointer font-semibold">How did the payload alter the original query?</summary>
              <p class="text-sm text-slate-200 mt-3">
                It injected its own conditional into the SQL string, turning the WHERE clause into a permanent truth and bypassing authentication.
              </p>
            </details>
            <details class="bg-slate-900/70 border border-purple-500/20 rounded-lg px-4 py-3">
              <summary class="cursor-pointer font-semibold">Why are prepared statements effective?</summary>
              <p class="text-sm text-slate-200 mt-3">
                They separate SQL structure from user data, so the database engine can no longer treat input as executable logic.
              </p>
            </details>
            <details class="bg-slate-900/70 border border-purple-500/20 rounded-lg px-4 py-3">
              <summary class="cursor-pointer font-semibold">How will you enforce defenses long term?</summary>
              <p class="text-sm text-slate-200 mt-3">
                Establish a shared database helper using parameter binding, add automated injection tests, and enforce secure coding reviews.
              </p>
            </details>
          </div>
        </div>

        <button
          class="w-full bg-purple-600 hover:bg-purple-500 px-6 py-3 rounded-xl font-semibold shadow-lg shadow-purple-500/20"
          onclick="goToSection(0)"
        >
          ‚Ü∫ Restart Mission Walkthrough
        </button>
      </section>
    </main>

    <script>
      const sections = Array.from(document.querySelectorAll(".mission-section"));
      const navButtons = Array.from(document.querySelectorAll(".mission-nav-btn"));

      function goToSection(index) {
        sections.forEach((section, i) => {
          section.classList.toggle("section-hidden", i !== index);
        });

        navButtons.forEach((btn) => btn.classList.replace("bg-purple-600", "bg-slate-800/80"));
        navButtons.forEach((btn) => btn.classList.replace("hover:bg-purple-500", "hover:bg-slate-700/80"));
        navButtons.forEach((btn) => btn.classList.replace("shadow-lg", "shadow-none"));
        navButtons.forEach((btn) => btn.classList.add("nav-idle"));

        const active = navButtons.find((b) => Number(b.dataset.section) === index);
        if (active) {
          active.classList.remove("nav-idle");
          active.classList.add("bg-purple-600", "hover:bg-purple-500", "shadow-lg", "shadow-purple-500/20");
        }
      }

      navButtons.forEach((button) => {
        button.addEventListener("click", () => goToSection(Number(button.dataset.section)));
      });

      // exploit simulation
      const exploitForm = document.getElementById("exploit-form");
      const exploitCodename = document.getElementById("exploit-codename");
      const exploitPasscode = document.getElementById("exploit-passcode");
      const exploitLog = document.getElementById("exploit-log");
      const exploitStatus = document.getElementById("exploit-status");
      const exploitLeak = document.getElementById("exploit-leak");

      const secureForm = document.getElementById("secure-form");
      const secureCodename = document.getElementById("secure-codename");
      const securePasscode = document.getElementById("secure-passcode");
      const secureLog = document.getElementById("secure-log");
      const secureStatus = document.getElementById("secure-status");
      const secureFragment = document.getElementById("secure-fragment");

      const AGENT_DB = [
        { codename: "GhostWolf", passcode: "hunter2", clearance: "Top Secret" },
        { codename: "NightFox", passcode: "wrath238", clearance: "Secret" },
        { codename: "AstraZero", passcode: "blueNova!", clearance: "Confidential" },
      ];

      const PAYLOAD = "' OR '1'='1";

      const stats = {
        attempts: 0,
        breaches: 0,
        secureRuns: 0,
      };

      function renderStats() {
        document.getElementById("stat-attempts").textContent = stats.attempts;
        document.getElementById("stat-breaches").textContent = stats.breaches;
        document.getElementById("stat-secure").textContent = stats.secureRuns;
      }

      function updateMeter({ breach, neutralised, success }) {
        let threat = Number(meterBar.dataset.threat || 20);
        if (breach) {
          threat = Math.min(100, threat + 40);
        } else if (neutralised) {
          threat = Math.max(15, threat - 35);
        } else if (success) {
          threat = Math.max(15, threat - 10);
        } else {
          threat = Math.max(15, threat - 5);
        }

        meterBar.dataset.threat = threat;
        meterBar.style.width = `${threat}%`;
        meterBar.classList.remove("warning", "danger");

        if (threat > 70) {
          meterBar.classList.add("danger");
          meterStatus.textContent = "Status: Critical Breach";
          wormhole.classList.add("wormhole--unstable");
        } else if (threat > 45) {
          meterBar.classList.add("warning");
          meterStatus.textContent = "Status: Breach Warning";
          wormhole.classList.add("wormhole--unstable");
        } else {
          meterStatus.textContent = "Status: Stable";
          wormhole.classList.remove("wormhole--unstable");
        }
      }

      function createQuery(codename, passcode, secureMode) {
        if (!secureMode) {
          return `SELECT * FROM agents WHERE codename = '${codename}' AND passcode = '${passcode}';`;
        }
        return "SELECT * FROM agents WHERE codename = ? AND passcode = ?;";
      }

      function matchAgents(codename, passcode) {
        return AGENT_DB.filter((agent) => agent.codename === codename && agent.passcode === passcode);
      }

      function isPayload(input) {
        return input.includes(PAYLOAD);
      }

      exploitForm.addEventListener("submit", (event) => {
        event.preventDefault();
        const codename = exploitCodename.value.trim();
        const passcode = exploitPasscode.value.trim();
        stats.attempts += 1;

        const query = createQuery(codename, passcode, false);
        const rows = matchAgents(codename, passcode);
        const payloadFired = isPayload(codename) || isPayload(passcode);
        const leakAll = payloadFired ? AGENT_DB : rows;

        const logLines = [
          `$ ${query}`,
          "",
          "Rows Returned:",
          leakAll.length
            ? leakAll.map((row, i) => `${i + 1}. ${row.codename} ‚Äî ${row.clearance}`).join("\n  ")
            : "  0 rows",
        ];

        exploitLog.textContent = logLines.join("\n");

        if (payloadFired) {
          stats.breaches += 1;
          exploitStatus.textContent = "Status: WORMHOLE OPEN ‚Äî Injection succeeded!";
          exploitLeak.textContent = `Rows Returned: ${leakAll.length}`;
          badgeStatus.textContent = "ALERT: Wormhole open ‚Äî payload bypassed authentication.";
          badgeStatus.classList.add("breach");
        } else {
          exploitStatus.textContent = "Status: Limited breach ‚Äî Only matching agents retrieved.";
          exploitLeak.textContent = `Rows Returned: ${leakAll.length}`;
          badgeStatus.textContent = "Partial leak detected. Harden defenses immediately.";
          badgeStatus.classList.add("breach");
        }

        updateMeter({ breach: true, neutralised: false, success: false });
        renderStats();
      });

      secureForm.addEventListener("submit", (event) => {
        event.preventDefault();
        const codename = secureCodename.value.trim();
        const passcode = securePasscode.value.trim();
        stats.attempts += 1;
        stats.secureRuns += 1;

        const query = createQuery(codename, passcode, true);
        const rows = matchAgents(codename, passcode);
        const payloadFired = isPayload(codename) || isPayload(passcode);
        const neutralised = payloadFired && rows.length === 0;

        const logLines = [
          `$ ${query}`,
          "",
          payloadFired
            ? "Payload detected. Treated as literal text."
            : "No payload detected. Checking credentials‚Ä¶",
          "",
          "Rows Returned:",
          rows.length
            ? rows.map((row, i) => `${i + 1}. ${row.codename} ‚Äî ${row.clearance}`).join("\n  ")
            : "  0 rows",
        ];

        secureLog.textContent = logLines.join("\n");

        if (neutralised) {
          secureStatus.textContent = "Status: Wormhole neutralised.";
          secureFragment.textContent = "Fragment: BRAVO-4M8Q";
          badgeStatus.textContent = "Payload neutralised. Wormhole collapsing.";
          badgeStatus.classList.remove("breach");
          badgeCode.textContent = "BRAVO-4M8Q";
          successCode.textContent = "BRAVO-4M8Q";
        } else if (rows.length) {
          secureStatus.textContent = `Status: Agent authenticated (${rows[0].codename}).`;
          secureFragment.textContent = "Fragment: BRAVO-4M8Q";
          badgeStatus.textContent = "Valid agent verified under secure mode.";
          badgeStatus.classList.remove("breach");
          badgeCode.textContent = "BRAVO-4M8Q";
          successCode.textContent = "BRAVO-4M8Q";
        } else {
          secureStatus.textContent = "Status: Access denied ‚Äî invalid credentials.";
          secureFragment.textContent = "Fragment: Pending reviewer approval";
          badgeStatus.textContent = "Defenses holding. Review credential source.";
          badgeStatus.classList.remove("breach");
          badgeCode.textContent = "‚Äî";
          successCode.textContent = "Pending";
        }

        updateMeter({ breach: false, neutralised, success: rows.length > 0 });
        renderStats();
      });

      goToSection(0);
      renderStats();
      meterBar.dataset.threat = 20;
      updateMeter({ breach: false, neutralised: false, success: true });
    </script>
  </body>
</html>
<<<<<<< ours
>>>>>>> theirs
=======
>>>>>>> theirs
